{
    "$schema": "./microsoft.powershell.crescendo.schema.json",
    "Commands": [
        {
            "Verb": "Get",
            "Noun": "VssProvider",
            "OriginalName": "$env:Windir/system32/vssadmin.exe",
            "OriginalCommandElements": [
                "list",
                "providers"
            ],
            "Description": "List registered volume shadow copy providers",
            "Usage": {
                "Synopsis": "List registered volume shadow copy providers",
                "HasOptions": false
            },
            "Platform": [
                "Windows"
            ],
            "OutputHandlers": [
                {
                    "ParameterSetName": "Default",
                    "HandlerType": "Function",
                    "Handler": "ParseProvider"
                }
            ],
            "Examples": [
                {
                    "Command": "Get-VssProvider",
                    "Description": "Get a list of VSS Providers",
                    "OriginalCommand": "vssadmin list providers"
                }
            ]
        },
        {
            "Verb": "Get",
            "Noun": "VssShadow",
            "OriginalName": "$env:Windir/system32/vssadmin.exe",
            "OriginalCommandElements": [
                "list",
                "shadows"
            ],
            "Description": "List existing volume shadow copies.",
            "Usage": {
                "Synopsis": "List existing volume shadow copies. Without any options, all shadow copies on the system are displayed ordered by shadow copy set. Combinations of options can be used to refine the output.",
                "HasOptions": true
            },
            "Platform": [
                "Windows"
            ],
            "DefaultParameterSetName": "Default",
            "Parameters": [
                {
                    "OriginalName": "/For=",
                    "Name": "For",
                    "ParameterType": "string",
                    "ParameterSetName": [
                        "Default"
                    ],
                    "NoGap": true,
                    "Description": "List the shadow copies for volume name like 'C:'"
                },
                {
                    "OriginalName": "/Shadow=",
                    "Name": "Shadow",
                    "ParameterType": "string",
                    "ParameterSetName": [
                        "Default"
                    ],
                    "NoGap": true,
                    "Description": "List shadow copies matching the Id in GUID format: '{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}'"
                },
                {
                    "OriginalName": "/Set=",
                    "Name": "Set",
                    "ParameterType": "string",
                    "ParameterSetName": [
                        "Default"
                    ],
                    "NoGap": true,
                    "Description": "List shadow copies matching the shadow set Id in GUID format: '{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}'"
                }
            ],
            "OutputHandlers": [
                {
                    "ParameterSetName": "Default",
                    "HandlerType": "Function",
                    "Handler": "ParseShadow"
                }
            ],
            "Examples": [
                {
                    "Command": "Get-VssShadow",
                    "Description": "Get a list of VSS shadow copies",
                    "OriginalCommand": "vssadmin list shadows"
                },
                {
                    "Command": "Get-VssShadow -For C:",
                    "Description": "Get a list of VSS shadow copies for volume C:",
                    "OriginalCommand": "vssadmin list shadows /For=C:"
                },
                {
                    "Command": "Get-VssShadow -Shadow '{c17ebda1-5da3-4f4a-a3dc-f5920c30ed0f}'",
                    "Description": "Get a specific shadow copy",
                    "OriginalCommand": "vssadmin list shadows /Shadow={c17ebda1-5da3-4f4a-a3dc-f5920c30ed0f}"
                },
                {
                    "Command": "Get-VssShadow -Set '{c17ebda1-5da3-4f4a-a3dc-f5920c30ed0f}'",
                    "Description": "Get the shadow copies for specific shadow set",
                    "OriginalCommand": "vssadmin list shadows /Shadow={3872a791-51b6-4d10-813f-64b4beb9f935}"
                }
            ]
        },
        {
            "Verb": "Get",
            "Noun": "VssShadowStorage",
            "OriginalName": "c:/windows/system32/vssadmin.exe",
            "OriginalCommandElements": [
                "list",
                "ShadowStorage"
            ],
            "Description": "List volume shadow copy storage associations. With no paramters, all associations are listed by default.",
            "Usage": {
                "Synopsis": "List volume shadow copy storage associations.",
                "HasOptions": true
            },
            "Platform": [
                "Windows"
            ],
            "DefaultParameterSetName": "ForVolume",
            "Parameters": [
                {
                    "OriginalName": "/For=",
                    "Name": "For",
                    "ParameterType": "string",
                    "ParameterSetName": [ "ForVolume" ],
                    "NoGap": true,
                    "Description": "List all associations for a given volume. Provide a volume name like 'C:'"
                },
                {
                    "OriginalName": "/On=",
                    "Name": "On",
                    "ParameterType": "string",
                    "ParameterSetName": [ "OnVolume" ],
                    "Mandatory": true,
                    "NoGap": true,
                    "Description": "List all associations on a given volume. Provide a volume name like 'C:'"
                }
            ],
            "OutputHandlers": [
                {
                    "ParameterSetName": "Default",
                    "HandlerType": "Function",
                    "Handler": "ParseShadowStorage"
                }
            ],
            "Examples": [
                {
                    "Command": "Get-VssShadowStorage",
                    "Description": "List all associations",
                    "OriginalCommand": "vssadmin list shadowstorage"
                },
                {
                    "Command": "Get-VssShadowStorage -For C:",
                    "Description": "List all associations for drive C:",
                    "OriginalCommand": "vssadmin list shadowstorage /For=C:"
                },
                {
                    "Command": "Get-VssShadowStorage -On C:",
                    "Description": "List all associations on drive C:",
                    "OriginalCommand": "vssadmin list shadowstorage /On=C:"
                }
            ]
        },
        {
            "Verb": "Get",
            "Noun": "VssVolume",
            "OriginalName": "c:/windows/system32/vssadmin.exe",
            "OriginalCommandElements": [
                "list",
                "volumes"
            ],
            "Description": "List volumes eligible for shadow copies",
            "Usage": {
                "Synopsis": "List volumes eligible for shadow copies",
                "HasOptions": false
            },
            "Platform": [
                "Windows"
            ],
            "OutputHandlers": [
                {
                    "ParameterSetName": "Default",
                    "HandlerType": "Function",
                    "Handler": "ParseVolume"
                }
            ],
            "Examples": [
                {
                    "Command": "Get-VssVolume",
                    "Description": "Get all volumes eligeble for shadow copies",
                    "OriginalCommand": "vssadmin list volumes"
                }
            ]
        },
        {
            "Verb": "Get",
            "Noun": "VssWriter",
            "OriginalName": "c:/windows/system32/vssadmin.exe",
            "OriginalCommandElements": [
                "list",
                "writers"
            ],
            "Description": "List subscribed volume shadow copy writers",
            "Usage": {
                "Synopsis": "List subscribed volume shadow copy writers",
                "HasOptions": false
            },
            "Platform": [
                "Windows"
            ],
            "OutputHandlers": [
                {
                    "ParameterSetName": "Default",
                    "HandlerType": "Function",
                    "Handler": "ParseWriter"
                }
            ],
            "Examples": [
                {
                    "Command": "Get-VssWriter",
                    "Description": "Get all VSS writers on the system",
                    "OriginalCommand": "vssadmin list writers"
                }
            ]
        }
    ]
}